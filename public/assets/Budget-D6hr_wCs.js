import{z as G,aa as i,ab as l,ac as e,ad as n,ag as U,ah as X,ai as Z,aj as J,y as T,aM as K,bi as Y,aZ as g,aS as h,aX as ee,bj as te,bk as re,bl as A,bm as ae,b6 as se,b8 as oe,b9 as ie}from"./chunk-OIYGIGL5-BJrXx6nP.js";import{E as R}from"./ErrorMessage-B_WJbRvy.js";import{H as ne}from"./h-stack-BAYxCJd_.js";import{S as m}from"./List.es-Bd0pNFBo.js";import{S as I}from"./separator-DjqbhJ3x.js";import{B as de}from"./BudgetActions-BJzIq5Ba.js";import{F as S}from"./flex-CGfNGPrr.js";import{T as C,B as le}from"./index-Bnpdpr_K.js";import{B as k}from"./button-DyY4O6zS.js";import{c as ce,d as ue,e as j,T as xe,a as E,b as f,o as me,f as p,C as ge,g as be,h as pe}from"./DotsThree.es-Cg5qqrhf.js";import{M as he,a as je,b as fe,c as Ce,d as we,r as Ee}from"./Trash.es-CUeaewor.js";import{B as ye,a as Pe}from"./index-6zcL0IWK.js";import{m as ve,c as Te}from"./index-Ba4_dbf1.js";import{u as B}from"./use-field-context-B6JgluHK.js";import{I as Ae}from"./icon-BpbeDfqG.js";import{F as N}from"./for-C-OR-lR2.js";import{H as Re}from"./index-D8E_lyqW.js";import"./center-BleJ6I63.js";import"./IconBase.es-D8AGYXbC.js";import"./omit-QLD0Eizt.js";import"./loader-CkjxkFhi.js";import"./index-BmXwFx4H.js";import"./index-YkouNUqG.js";import"./iconBase-HbJlbdFW.js";const[M,c]=G({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),z=i.forwardRef((t,r)=>{const a=c(),s=l(a.getAreaProps(),t);return e.jsx(n.div,{...s,ref:r})});z.displayName="EditableArea";const F=i.forwardRef((t,r)=>{const a=c(),s=l(a.getCancelTriggerProps(),t);return e.jsx(n.button,{...s,ref:r})});F.displayName="EditableCancelTrigger";const H=i.forwardRef((t,r)=>{const a=c(),s=l(a.getControlProps(),t);return e.jsx(n.div,{...s,ref:r})});H.displayName="EditableControl";const L=i.forwardRef((t,r)=>{const a=c(),s=l(a.getEditTriggerProps(),t);return e.jsx(n.button,{...s,ref:r})});L.displayName="EditableEditTrigger";const O=i.forwardRef((t,r)=>{const a=c(),s=l(a.getInputProps(),t),o=B();return e.jsx(n.input,{"aria-describedby":o?.ariaDescribedby,...s,ref:r})});O.displayName="EditableInput";const V=i.forwardRef((t,r)=>{const a=c(),s=l(a.getLabelProps(),t);return e.jsx(n.label,{...s,ref:r})});V.displayName="EditableLabel";const _=i.forwardRef((t,r)=>{const a=c(),s=l(a.getPreviewProps(),t);return e.jsx(n.span,{...s,ref:r})});_.displayName="EditablePreview";const w=t=>{const r=i.useId(),{getRootNode:a}=U(),{dir:s}=X(),o=B(),d={id:r,ids:{label:o?.ids.label,input:o?.ids.control},dir:s,disabled:o?.disabled,invalid:o?.invalid,readOnly:o?.readOnly,required:o?.required,getRootNode:a,...t},x=Z(ve,d);return Te(x,J)},D=i.forwardRef((t,r)=>{const[a,s]=T()(t,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),o=w(a),d=l(o.getRootProps(),s);return e.jsx(M,{value:o,children:e.jsx(n.div,{...d,ref:r})})});D.displayName="EditableRoot";const q=i.forwardRef((t,r)=>{const[{value:a},s]=T()(t,["value"]),o=l(a.getRootProps(),s);return e.jsx(M,{value:a,children:e.jsx(n.div,{...o,ref:r})})});q.displayName="EditableRootProvider";const $=i.forwardRef((t,r)=>{const a=c(),s=l(a.getSubmitTriggerProps(),t);return e.jsx(n.button,{...s,ref:r})});$.displayName="EditableSubmitTrigger";const{withProvider:W,withContext:u}=K({key:"editable"}),y=W(q,"root",{forwardAsChild:!0});W(D,"root",{forwardAsChild:!0});const P=u(_,"preview",{forwardAsChild:!0});u(V,"label",{forwardAsChild:!0});const v=u(O,"input",{forwardAsChild:!0}),Ie=i.forwardRef(function(r,a){const s=c(),o=Y(s.getInputProps(),r);return e.jsx(n.textarea,{ref:a,...o})});u(Ie,"input",{forwardAsChild:!0});u(H,"control",{forwardAsChild:!0});u(z,"area",{forwardAsChild:!0});u(L,"editTrigger",{forwardAsChild:!0});u($,"submitTrigger",{forwardAsChild:!0});u(F,"cancelTrigger",{forwardAsChild:!0});const Se=()=>{const t=e.jsxs(g,{children:[e.jsx(m,{height:"6",width:"full"}),e.jsx(m,{height:"4",width:"full"}),e.jsx(m,{height:"4",width:"full"}),e.jsx(m,{height:"4",width:"full"})]});return e.jsxs(g,{gap:"5",children:[e.jsxs(ne,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(g,{children:[e.jsx(m,{height:"8",width:"xs"}),e.jsx(m,{height:"3",width:"xs",mb:"2"})]}),e.jsx(m,{height:"8",width:"60"})]}),e.jsx(I,{}),e.jsxs(g,{gap:"10",children:[t,t,t]})]})},ke=({type:t,handleCreateCategory:r})=>{const a=h.capitalize(t+"s");return e.jsx(ce,{mb:"4",captionSide:"top",fontSize:"md",textAlign:"start",children:e.jsxs(S,{alignItems:"center",justifyContent:"space-between",children:[e.jsx(C,{children:a}),e.jsxs(k,{onClick:r,size:"xs",variant:"outline",children:["Add ",h.capitalize(t)]})]})})},Be=()=>e.jsxs(ue,{children:[e.jsx(j,{htmlWidth:"70%"}),e.jsx(j,{htmlWidth:"20%"}),e.jsx(j,{})]}),Ne=()=>e.jsx(xe,{children:e.jsxs(E,{children:[e.jsx(f,{children:"Name"}),e.jsx(f,{textAlign:"end",children:"Amount"}),e.jsx(f,{textAlign:"end",children:"Actions"})]})}),Me=({categoryId:t,handleDelete:r})=>e.jsxs(he,{closeOnSelect:!0,variant:"subtle",children:[e.jsx(je,{asChild:!0,children:e.jsx(k,{variant:"ghost",onClick:a=>a.stopPropagation(),children:e.jsx(me,{})})}),e.jsx(ee,{children:e.jsx(fe,{children:e.jsx(Ce,{children:e.jsxs(we,{value:"delete",color:"red",onClick:()=>r(t),children:[e.jsx(Ee,{}),e.jsx(le,{flex:"1",children:"Delete"})]})})})})]}),ze=({category:t,currency:r})=>{const[a]=te(),[s]=re(),o=w({required:!0,defaultValue:t.name,placeholder:"Click to edit",onValueCommit:async x=>await s({body:{budgetId:t.budgetId,name:x.value},params:{categoryId:t._id}})}),d=w({required:!0,defaultValue:t.plannedAmount.toString(),onValueCommit:async x=>{await s({body:{budgetId:t.budgetId,plannedAmount:parseFloat(x.value)||0},params:{categoryId:t._id}})}});return e.jsxs(E,{children:[e.jsx(p,{children:e.jsxs(y,{value:o,children:[e.jsx(P,{}),e.jsx(v,{})]})}),e.jsx(p,{children:e.jsxs(y,{value:d,justifyContent:"end",textAlign:"end",children:[e.jsx(P,{}),e.jsx(v,{}),e.jsx(Ae,{size:"sm",color:"gray.500",children:r==="NIS"?e.jsx(ye,{}):e.jsx(Pe,{})})]})}),e.jsx(p,{textAlign:"end",children:e.jsx(Me,{categoryId:t._id,handleDelete:a})})]})},Fe=({type:t})=>e.jsx(E,{children:e.jsxs(p,{colSpan:3,textAlign:"center",py:"6",color:"gray.500",children:["No ",t,"s yet. Click ",e.jsxs(ge,{children:["Add ",h.capitalize(t)]})," to get started."]})}),He=({type:t,budgetId:r,currency:a})=>{const{data:s}=A({budgetId:r,type:t});return e.jsx(be,{children:e.jsx(N,{each:s,fallback:e.jsx(Fe,{type:t}),children:o=>e.jsx(ze,{category:o,currency:a},o._id)})})},Le=({budgetId:t,currency:r,type:a})=>{const{data:s,error:o,isLoading:d}=A({budgetId:t,type:a}),[x]=ae(),Q=async()=>{await x({budgetId:t,name:"Click to Edit",plannedAmount:0,type:a})};let b=null;return o&&(b=e.jsx(R,{error:"Could not load categories"})),d&&(b=e.jsx("div",{children:"Loading..."})),s&&(b=e.jsxs(pe,{variant:"outline",children:[e.jsx(ke,{type:a,handleCreateCategory:Q}),e.jsx(Be,{}),e.jsx(Ne,{}),e.jsx(He,{type:a,budgetId:t,currency:r})]})),b},Oe=({date:t,name:r,notes:a=""})=>e.jsxs(g,{children:[e.jsxs(Re,{size:"xl",children:[t.month," / ",t.year]}),e.jsx(C,{color:"fg.subtle",fontWeight:"semibold",children:h.capitalize(r)}),e.jsx(C,{fontSize:"sm",children:a})]}),ct=()=>{const{id:t}=se(),{data:r,error:a,isLoading:s}=oe(t??ie);if(a)return e.jsx(R,{error:"Could not show budget..."});if(s)return e.jsx(Se,{});if(!r)return null;const o=["income","expense","saving"];return e.jsxs(g,{as:"section",gap:"4",children:[e.jsxs(S,{justifyContent:"space-between",alignItems:"end",gap:"4",children:[e.jsx(Oe,{date:r.date,name:r.name,notes:r.notes}),e.jsx(de,{budgetId:r._id})]}),e.jsx(I,{}),e.jsx(g,{gap:"8",children:e.jsx(N,{each:o,children:d=>e.jsx(Le,{budgetId:r._id,currency:r.currency,type:d},d)})})]})};export{ct as Budget};
