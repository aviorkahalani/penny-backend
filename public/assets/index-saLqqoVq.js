import{b as B,h as R,v as N,j as S,aw as U,ax as $,bn as d,bo as I,aA as q,bp as K,d as W}from"./chunk-OIYGIGL5-Dz3lc_zy.js";var j=B("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),v=j.build(),G=e=>e.ids?.root??`editable:${e.id}`,H=e=>e.ids?.area??`editable:${e.id}:area`,J=e=>e.ids?.label??`editable:${e.id}:label`,L=e=>e.ids?.preview??`editable:${e.id}:preview`,C=e=>e.ids?.input??`editable:${e.id}:input`,Q=e=>e.ids?.control??`editable:${e.id}:control`,M=e=>e.ids?.submitTrigger??`editable:${e.id}:submit`,D=e=>e.ids?.cancelTrigger??`editable:${e.id}:cancel`,A=e=>e.ids?.editTrigger??`editable:${e.id}:edit`,O=e=>e.getById(C(e)),X=e=>e.getById(L(e)),Y=e=>e.getById(M(e)),Z=e=>e.getById(D(e)),_=e=>e.getById(A(e));function te(e,t){const{state:i,context:l,send:a,prop:r,scope:u,computed:h}=e,c=!!r("disabled"),s=h("isInteractive"),T=!!r("readOnly"),F=!!r("required"),f=!!r("invalid"),g=!!r("autoResize"),b=r("translations"),o=i.matches("edit"),E=r("placeholder"),V=typeof E=="string"?{edit:E,preview:E}:E,m=l.get("value"),y=m.trim()==="",w=y?V?.preview??"":m;return{editing:o,empty:y,value:m,valueText:w,setValue(n){a({type:"VALUE.SET",value:n,src:"setValue"})},clearValue(){a({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){s&&a({type:"EDIT"})},cancel(){s&&a({type:"CANCEL"})},submit(){s&&a({type:"SUBMIT"})},getRootProps(){return t.element({...v.root.attrs,id:G(u),dir:r("dir")})},getAreaProps(){return t.element({...v.area.attrs,id:H(u),dir:r("dir"),style:g?{display:"inline-grid"}:void 0,"data-focus":d(o),"data-disabled":d(c),"data-placeholder-shown":d(y)})},getLabelProps(){return t.label({...v.label.attrs,id:J(u),dir:r("dir"),htmlFor:C(u),"data-focus":d(o),"data-invalid":d(f),"data-required":d(F),onClick(){if(o)return;X(u)?.focus({preventScroll:!0})}})},getInputProps(){return t.input({...v.input.attrs,dir:r("dir"),"aria-label":b?.input,name:r("name"),form:r("form"),id:C(u),hidden:g?void 0:!o,placeholder:V?.edit,maxLength:r("maxLength"),required:r("required"),disabled:c,"data-disabled":d(c),readOnly:T,"data-readonly":d(T),"aria-invalid":I(f),"data-invalid":d(f),"data-autoresize":d(g),defaultValue:m,size:g?1:void 0,onChange(n){a({type:"VALUE.SET",src:"input.change",value:n.currentTarget.value})},onKeyDown(n){if(n.defaultPrevented||q(n))return;const P={Escape(){a({type:"CANCEL"}),n.preventDefault()},Enter(p){if(!h("submitOnEnter"))return;const{localName:k}=p.currentTarget;if(k==="textarea"){if(!(K()?p.metaKey:p.ctrlKey))return;a({type:"SUBMIT",src:"keydown.enter"});return}k==="input"&&!p.shiftKey&&!p.metaKey&&(a({type:"SUBMIT",src:"keydown.enter"}),p.preventDefault())}}[n.key];P&&P(n)},style:g?{gridArea:"1 / 1 / auto / auto",visibility:o?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:L(u),...v.preview.attrs,dir:r("dir"),"data-placeholder-shown":d(y),"aria-readonly":I(T),"data-readonly":d(c),"data-disabled":d(c),"aria-disabled":I(c),"aria-invalid":I(f),"data-invalid":d(f),"aria-label":b?.edit,"data-autoresize":d(g),children:w,hidden:g?void 0:o,tabIndex:s?0:void 0,onClick(){s&&r("activationMode")==="click"&&a({type:"EDIT",src:"click"})},onFocus(){s&&r("activationMode")==="focus"&&a({type:"EDIT",src:"focus"})},onDoubleClick(n){n.defaultPrevented||s&&r("activationMode")==="dblclick"&&a({type:"EDIT",src:"dblclick"})},style:g?{whiteSpace:"pre",gridArea:"1 / 1 / auto / auto",visibility:o?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...v.editTrigger.attrs,id:A(u),dir:r("dir"),"aria-label":b?.edit,hidden:o,type:"button",disabled:c,onClick(n){n.defaultPrevented||s&&a({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:Q(u),...v.control.attrs,dir:r("dir")})},getSubmitTriggerProps(){return t.button({...v.submitTrigger.attrs,dir:r("dir"),id:M(u),"aria-label":b?.submit,hidden:!o,disabled:c,type:"button",onClick(n){n.defaultPrevented||s&&a({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...v.cancelTrigger.attrs,dir:r("dir"),"aria-label":b?.cancel,id:D(u),hidden:!o,type:"button",disabled:c,onClick(n){n.defaultPrevented||s&&a({type:"CANCEL",src:"cancel.click"})}})}}}var ie=R({props({props:e}){return{activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}},initialState({prop:e}){return e("edit")||e("defaultEdit")?"edit":"preview"},entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(i){return t("onValueChange")?.({value:i})}})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:i,prop:l}){e([()=>i.get("value")],()=>{t(["syncInputValue"])}),e([()=>l("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){const t=e("submitMode");return t==="both"||t==="enter"},submitOnBlur({prop:e}){const t=e("submitMode");return t==="both"||t==="blur"},isInteractive({prop:e}){return!(e("disabled")||e("readOnly"))}},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInput"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],entry:["syncInputValue"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>e("edit")!=null,isSubmitEvent:({event:e})=>e.previousEvent?.type==="SUBMIT"},effects:{trackInteractOutside({send:e,scope:t,prop:i,computed:l}){return U(O(t),{exclude(a){return[Z(t),Y(t)].some(u=>$(u,a))},onFocusOutside:i("onFocusOutside"),onPointerDownOutside:i("onPointerDownOutside"),onInteractOutside(a){if(i("onInteractOutside")?.(a),a.defaultPrevented)return;const{focusable:r}=a.detail;e({type:l("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:r})}})}},actions:{restoreFocus({event:e,scope:t,prop:i}){e.focusable||S(()=>{(i("finalFocusEl")?.()??_(t))?.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){S(()=>{const i=O(e);i&&(t("selectOnFocus")?i.select():i.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){const i=t.get("previousValue");e("onValueRevert")?.({value:i})},invokeOnSubmit({prop:e,context:t}){const i=t.get("value");e("onValueCommit")?.({value:i})},invokeOnEdit({prop:e}){e("onEditChange")?.({edit:!0})},invokeOnPreview({prop:e}){e("onEditChange")?.({edit:!1})},toggleEditing({prop:e,send:t,event:i}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:i})},syncInputValue({context:e,scope:t}){const i=O(t);i&&N(i,e.get("value"))},setValue({context:e,prop:t,event:i}){const l=t("maxLength"),a=l!=null?i.value.slice(0,l):i.value;e.set("value",a)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){const t=e.get("previousValue");t&&e.set("value",t)},blurInput({scope:e}){O(e)?.blur()}}}});W()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);export{j as a,te as c,ie as m};
